---
layout: post
title: Service Worker 소개
excerpt: "서비스워커에 대해 대략적인 설명"
categories: [serviceworker]
comments: true
---

## 서비스워커는 무엇인가?
- 서비스 워커는 브라우저가 백그라운드에서 실행하는 스크립트이다.
- 웹페이지와는 별개로 작동한다.
- 현재버전으로 푸시알림 & 백그라운드 동기화 기능이 제공되고 있다.
- 추후 주기적 동기화, 지오펜싱(실제 위치에 기반한 가상의 경계나 구역을 만드는 기술)과 같은 다른기능을 지원할 예정이다.
- 서비스 워커 이전에 **AppCache**라는 API가 있었지만 다양한 문제가 있었으며 서비스워커는 이를 방지하도록 설계 되었다.

> 오프라인 환경을 통제할 수 있는 권한을 개발자에게 부여하여 오프라인 환경을 지원할 수 있도록 해준다.

## 수명주기
- 서비스 워커의 수명주기는 웹페이지와 완전히 별개.
- **자바스크립트**를 이용하여 서비스워커를 웹사이트에 설치할 수 있다.
- 서비스워커를 등록하면 브라우저가 백그라운드에서 서비스 워커 설치 단계를 시작한다.
- 설치 단계동안 정적 자산을 설치단계 동안 캐시작업을 진행하며 모든 파일이 성공적으로 캐시되면 서비스 워커가 설치된다.
- 파일 다운로드 및 캐시에 실패하면 설치 단계가 실패하고 서비스 워커가 설치되지 않는다.
- **설치가 실패** 되더라도 재실행이 된다.
- 설치완료 후 활성화 단계가 진행되며 이 단계에서 오래된 캐시를 관리할 수 있다.
- 활성화 단계 후 해당 범위 안의 모든 페이지를 제어하지만 서비스 워커를 처음 등록한 페이지는 리로드해야 제어할 수 있다.
- 서비스워커에 제어 권한이 부여된 경우 메모리를 절약하기 위해 종료되거나 페이지에서 네트워크 요청이나 메세지가 생성될 때 fetch 및 message이벤트를 처리한다.

<img src="https://developers.google.com/web/fundamentals/primers/service-workers/images/sw-lifecycle.png?hl=ko" alt="서비스워커 수명주기" width="400" />

## 브라우저 지원
>대다수의 브라우저에서 지원하며 IE경우 엣지 +17 이상부터 원할한 사용이 가능하다. <br/> [브라우저 지원 현황](https://jakearchibald.github.io/isserviceworkerready/)

## HTTPS

**로컬호스트**를 통해 개발이 가능하지만 사이트에 배포시 HTTPS가 필요하다. 하이재킹이나 응답을 필터하여 악의적으로 이용당할 수 있기 때문에 HTTPS로 제공되는 페이지에서만 등록이 가능하다.

<hr/>

[참조 - 구글 서비스워커](https://developers.google.com/web/fundamentals/primers/service-workers/?hl=ko)